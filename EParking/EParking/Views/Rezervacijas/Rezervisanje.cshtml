@model EParking.Models.Rezervacija
@{
    ViewBag.Title = "Rezervisanje";
}
@{ 
    var data = ViewBag.mjesta;
}
<style>
    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    td, th {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #dddddd;
    }

    .buttonclass {
        display: inline-block;
        background-color: mediumaquamarine;
        border-radius: 10px;
        border: 4px double #cccccc;
        color: black;
        text-align: center;
        font-size: 15px;
        -webkit-transition: all 0.5s;
        -moz-transition: all 0.5s;
        -o-transition: all 0.5s;
        transition: all 0.5s;
        cursor: pointer;
        width: 200px
    }

    .button-corner {
        display: inline-block;
        background-color: mediumaquamarine;
        border-radius: 10px;
        border: 4px double #cccccc;
        color: black;
        text-align: center;
        font-size: 12px;
        -webkit-transition: all 0.5s;
        -moz-transition: all 0.5s;
        -o-transition: all 0.5s;
        transition: all 0.5s;
        cursor: pointer;
        position: absolute;
        bottom: 20px;
        right: 20px;
    }

    #insertitem {
        width: 100%;
        padding: 2px;
        font-size: 20px;
        cursor: pointer;
    }


    #grid-gap {
        display: grid;
        grid-template-columns: auto auto;
        grid-gap: 20px;
        margin: 20px
    }

    div.cell {
        background: LightBlue;
        border: 1px solid Blue;
        padding: 10px;
    }
</style>


<style type="text/css">

    .skyblue {
        top: 20%;
        left: 20%;
        z-index: 1000;
        position: absolute;
        background-color: skyblue;
        display: compact;
    }

    .showPopUp {
        background-color: #e6fff2;
        filter: alpha(opacity=100);
        opacity: 1;
        width: 100%;
        height: 100%;
        z-index: auto;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: auto
    }


    .hidepopup {
        display: none;
    }

    .brown {
        background-color: #e6fff2;
        filter: alpha(opacity=100);
        opacity: 1;
        width: 100%;
        height: 100%;
        z-index: auto;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: auto
    }

    .vrijeme {
        display: inline-block;
    }

    .vrijemeLabela {
        display: block;
    }
</style>


<div id="errorDivMjesto" style="width:250px;height:200px;border-color:blue;border-style:solid" align="center" class="hidepopup">
    <p><b>Greška</b></p>
    <hr />
    <p>Pogrešan ID mjesta!</p>
    <button class="button-corner" onclick="javascript: Zatvori();"> <b>Zatvori</b></button>
</div>
<div id="errorDivVrijeme" style="width:250px;height:200px;border-color:blue;border-style:solid" align="center" class="hidepopup">
    <p><b>Greška</b></p>
    <hr />
    <p>Vrijeme početka mora biti prije vremena kraja!</p>
    <button class="button-corner" onclick="javascript: Zatvori();"> <b>Zatvori</b></button>
</div>

<h1 style="padding-bottom:50px">Rezervacija</h1>

    

<div>
    <table id="tabelaMjesta">
        <thead>
            <tr>
                <th>
                    ID
                </th>
                <th>
                    Sprat
                </th>
                <th>
                    Red
                </th>
                <th>
                    Kolona
                </th>
                <th>
                    Vrsta
                </th>

            </tr>
        </thead>
        <tbody>
            @foreach (var item in data)
            {
                <tr>
                    <td name="sprat">
                        @item.ID
                    </td>
                    <td name="sprat">
                        @item.Sprat
                    </td>
                    <td name="red">
                        @item.Red
                    </td>
                    <td name="kolona">
                        @item.Kolona
                    </td>
                    <td>
                        @item.Discriminator
                    </td>

                </tr>
            }
        </tbody>
    </table>


</div>
   
<form asp-action="Rezervisanje" id="form-rezervacija">


    <div style="padding-top:150px">
        <b style="padding-right:10px ; font-size:17px">Mjesto: </b>
        <input asp-for="KorisnikID" value="1" type="hidden" />
        <input asp-for="MjestoID" id="rednibroj" min="0">

        <i style="padding-left:20px ; font-size:12px">*Napomena: Unesite ID mjesta </i>
        <hr />
    </div>


    <div>
        <p style="font-size:17px"><b>Vrijeme rezervacije: </b></p>
        <label class="vrijemeLabela">Vrijeme pocetka rezervacije: </label>
        <div class="vrijeme">
            <input id="pocetak" asp-for="VrijemePocetka" asp-format="{0:dd/MM/yyyy HH:mm}" />
            <span asp-validation-for="VrijemePocetka" class="text-danger"></span>
        </div>
        <label style="margin-top:20px" class="vrijemeLabela">Vrijeme završetka rezervacije: </label>

        <div class="vrijeme">
            <input id="kraj" asp-for="VrijemeIsteka" asp-format="{0:dd/MM/yyyy HH:mm}" />
            <span asp-validation-for="VrijemeIsteka" class="text-danger"></span>
        </div>
    </div>

    <div style="margin-top:50px">
        <button type="button" onClick="javascript: Provjera();" class="buttonclass"><b>Završi rezervaciju</b></button>
    </div>



</form>

<script type="text/javascript">

    var izabranaKategorija

    function Zatvori() {
        document.getElementById("errorDivMjesto").className = "hidepopup"
        document.getElementById("errorDivVrijeme").className = "hidepopup"
    }

    function Provjera() {

        var rednibroj = document.getElementById("rednibroj").value
        var tabela = document.getElementById("tabelaMjesta")
        var postojiRed = false;
        var redovi = tabela.rows;

        for (var i = 1; i < redovi.length; i++) {
            if (parseInt(redovi[i].cells[0].innerHTML, 10) == rednibroj) {
                postojiRed = true;
            }
        }
        
            
        
        var pocetak = document.getElementById("pocetak").value;
        var kraj = document.getElementById("kraj").value;
        if (!postojiRed) {
            document.getElementById("errorDivMjesto").className = "showPopUp"
        }
        else if(pocetak>kraj) { 
           document.getElementById("errorDivVrijeme").className = "showPopUp"
        }
        else {
            document.getElementById("form-rezervacija").submit();
        }

    }

</script>
@*
    @section Scripts {
        @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    }
*@


